(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22e0ec"],{f9ad:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"i-layout-page-header"},[s("PageHeader",{attrs:{title:"新建入库/编辑入库","breadcrumb-list":t.breadcrumbList}})],1),s("Form",{ref:"form",staticClass:" ivu-mt",attrs:{model:t.storage}},[s("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":"",title:"基本信息"}},[s("Row",{attrs:{gutter:24}},[s("Col",{attrs:{xl:8,lg:8,md:8,sm:24,xs:24}},[s("FormItem",{attrs:{label:"出库类型",prop:"type",rules:t.ruled}},[s("Select",{model:{value:t.storage.type,callback:function(e){t.$set(t.storage,"type",e)},expression:"storage.type"}},[s("Option",{attrs:{value:"1"}},[t._v("销售出库")])],1)],1)],1),s("Col",{attrs:{xl:8,lg:8,md:8,sm:24,xs:24}},[s("FormItem",{attrs:{label:"仓库",prop:"warehouseName",rules:t.ruled}},[s("Input",{model:{value:t.storage.warehouseName,callback:function(e){t.$set(t.storage,"warehouseName",e)},expression:"storage.warehouseName"}})],1)],1),s("Col",{attrs:{xl:8,lg:8,md:8,sm:24,xs:24}},[s("FormItem",{attrs:{label:"出库时间/销售时间",prop:"outTime",rules:t.ruled}},[s("Input",{attrs:{type:"date"},model:{value:t.storage.outTime,callback:function(e){t.$set(t.storage,"outTime",e)},expression:"storage.outTime"}})],1)],1),s("Col",{attrs:{xl:8,lg:8,md:8,sm:24,xs:24}},[s("FormItem",{attrs:{label:"出库单号",prop:"outNumber",rules:t.ruled}},[s("Input",{attrs:{placeholder:"请输入"},model:{value:t.storage.outNumber,callback:function(e){t.$set(t.storage,"outNumber",e)},expression:"storage.outNumber"}})],1)],1),s("Col",{attrs:{xl:8,lg:8,md:8,sm:24,xs:24}},[s("FormItem",{attrs:{label:"客户名称",prop:"customer",rules:t.ruled}},[s("Input",{attrs:{placeholder:"请输入"},model:{value:t.storage.customer,callback:function(e){t.$set(t.storage,"customer",e)},expression:"storage.customer"}})],1)],1),s("Col",{attrs:{xl:8,lg:8,md:8,sm:24,xs:24}},[s("FormItem",{attrs:{label:"销售员",prop:"principal",rules:t.ruled}},[s("Input",{attrs:{placeholder:"请输入"},model:{value:t.storage.principal,callback:function(e){t.$set(t.storage,"principal",e)},expression:"storage.principal"}})],1)],1),s("Col",{attrs:{xl:8,lg:8,md:8,sm:24,xs:24}},[s("FormItem",{attrs:{label:"收货人",prop:"contact",rules:t.ruled}},[s("Input",{attrs:{placeholder:"请输入"},model:{value:t.storage.contact,callback:function(e){t.$set(t.storage,"contact",e)},expression:"storage.contact"}})],1)],1),s("Col",{attrs:{xl:8,lg:8,md:8,sm:24,xs:24}},[s("FormItem",{attrs:{label:"收货人电话",prop:"contactPhone",rules:t.ruled}},[s("Input",{attrs:{placeholder:"请输入"},model:{value:t.storage.contactPhone,callback:function(e){t.$set(t.storage,"contactPhone",e)},expression:"storage.contactPhone"}})],1)],1),s("Col",{attrs:{xl:8,lg:8,md:8,sm:24,xs:24}},[s("FormItem",{attrs:{label:"收货地址",prop:"region"}},[s("Input",{attrs:{placeholder:"请输入"},model:{value:t.storage.region,callback:function(e){t.$set(t.storage,"region",e)},expression:"storage.region"}})],1)],1),s("Col",{attrs:{xl:16,lg:16,md:16,sm:24,xs:24}},[s("FormItem",{attrs:{label:"详细地址",prop:"address"}},[s("Input",{attrs:{placeholder:"请输入"},model:{value:t.storage.address,callback:function(e){t.$set(t.storage,"address",e)},expression:"storage.address"}})],1)],1),s("Col",{attrs:{xl:24,lg:24,md:24,sm:24,xs:24}},[s("FormItem",{attrs:{label:"备注",prop:"remark"}},[s("Input",{attrs:{type:"textarea",rows:4,placeholder:"请输入备注"},model:{value:t.storage.remark,callback:function(e){t.$set(t.storage,"remark",e)},expression:"storage.remark"}})],1)],1)],1)],1),s("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":"",title:"销售明细"}},[s("out-form",{ref:"outForm"})],1),s("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":"",title:"物流信息"}},[s("logistics-form",{ref:"logisticsForm"})],1)],1),s("FooterToolbar",[s("Button",{attrs:{type:"primary",loading:t.loading,size:"large"},on:{click:t.handleSubmit}},[t._v("提交")])],1)],1)},a=[],i=(s("a481"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Form",{ref:"material",staticClass:"ivu-mt",attrs:{model:t.outList}},[s("Table",{ref:"process",attrs:{data:t.outData,columns:t.outListColumn},scopedSlots:t._u([{key:"name",fn:function(e){var r=e.row,a=e.index;return[t.editIndex===a?s("FormItem",{attrs:{prop:"name",rules:t.ruled}},[s("Input",{staticClass:"ivu-mt-16",attrs:{type:"text",placeholder:"请输入物料名称"},model:{value:t.outList.name,callback:function(e){t.$set(t.outList,"name",e)},expression:"outList.name"}})],1):s("span",[t._v(t._s(r.name))])]}},{key:"specification",fn:function(e){var r=e.row,a=e.index;return[t.editIndex===a?s("FormItem",{attrs:{prop:"specification",rules:t.ruled}},[s("Input",{staticClass:"ivu-mt-16",attrs:{type:"text",placeholder:"规格"},model:{value:t.outList.specification,callback:function(e){t.$set(t.outList,"specification",e)},expression:"outList.specification"}})],1):s("span",[t._v(t._s(r.specification))])]}},{key:"batchNumber",fn:function(e){var r=e.row,a=e.index;return[t.editIndex===a?s("FormItem",{staticClass:"ivu-mt-16",attrs:{prop:"batchNumber",rules:t.ruled}},[s("Input",{attrs:{type:"text",placeholder:"请输入批号"},model:{value:t.outList.batchNumber,callback:function(e){t.$set(t.outList,"batchNumber",e)},expression:"outList.batchNumber"}})],1):s("span",[t._v(t._s(r.batchNumber))])]}},{key:"amount",fn:function(e){var r=e.row,a=e.index;return[t.editIndex===a?s("FormItem",{attrs:{prop:"amount",rules:t.ruled}},[s("Input",{staticClass:"ivu-mt-16",attrs:{type:"number",placeholder:"数量"},on:{"on-change":t.handleAmount},model:{value:t.outList.amount,callback:function(e){t.$set(t.outList,"amount",e)},expression:"outList.amount"}})],1):s("span",[t._v(t._s(r.amount))])]}},{key:"unit",fn:function(e){var r=e.row,a=e.index;return[t.editIndex===a?s("FormItem",{staticClass:"ivu-mt-16",attrs:{prop:"unit",rules:t.ruled}},[s("Input",{attrs:{type:"text",placeholder:"单位"},model:{value:t.outList.unit,callback:function(e){t.$set(t.outList,"unit",e)},expression:"outList.unit"}})],1):s("span",[t._v(t._s(r.unit))])]}},{key:"price",fn:function(e){var r=e.row,a=e.index;return[t.editIndex===a?s("FormItem",{staticClass:"ivu-mt-16",attrs:{prop:"price",rules:t.ruled}},[s("Input",{attrs:{type:"number",placeholder:"单价"},on:{"on-change":t.handlePrice},model:{value:t.outList.price,callback:function(e){t.$set(t.outList,"price",e)},expression:"outList.price"}})],1):s("span",[t._v(t._s(r.price))])]}},{key:"subTotal",fn:function(e){var r=e.row,a=e.index;return[t.editIndex===a?s("p",[t._v(t._s(t.outList.subTotal))]):s("span",[t._v(t._s(r.subTotal))])]}},{key:"action",fn:function(e){e.row;var r=e.index;return[t.editIndex===r?s("div",[s("Button",{staticClass:"ivu-ml",attrs:{type:"error",ghost:"",size:"small"},on:{click:function(e){return t.handleDelete(r)}}},[t._v("删除")])],1):s("div",[s("Poptip",{attrs:{confirm:"",transfer:"",title:"是否要删除此行？"},on:{"on-ok":function(e){return t.handleDelete(r)}}},[s("Button",{staticClass:"ivu-ml",attrs:{type:"error",disabled:t.addNew,ghost:"",size:"small"}},[t._v("删除")])],1)],1)]}}])})],1),s("Button",{staticClass:"ivu-mt",attrs:{type:"dashed",long:"",icon:"md-add"},on:{click:t.handleAdd}},[t._v("新增记录")])],1)}),o=[],l={name:"out-form",data:function(){return{loading:!1,outList:{name:"",specification:"",batchNumber:"",amount:"",unit:"",price:"",subTotal:"",total:""},outListColumn:[{title:"物料名称",slot:"name",minWidth:60},{title:"规格",slot:"specification",minWidth:60},{title:"内部批号",slot:"batchNumber",minWidth:100},{title:"数量",slot:"amount",minWidth:120},{title:"单位",slot:"unit",minWidth:120},{title:"单价",slot:"price",minWidth:40},{title:"小计",slot:"subTotal",minWidth:40},{title:"操作",slot:"action",align:"center",width:140}],ruled:{required:!0,message:"请输入",trigger:"blur"},editIndex:-1,addNew:!1,outData:[]}},methods:{handleEdit:function(t,e){this.outList=t,this.editIndex=e},handleRuled:function(){var t=!1;return this.$refs.material.validate((function(e){t=e})),t},handleAdd:function(){if(this.addNew=!0,!this.handleRuled())return 0;var t={name:"",specification:"",batchNumber:"",amount:"",unit:"",price:"",subTotal:"-",total:"-"};this.outData.push(t),this.handleEdit(t,this.outData.length-1)},handleDelete:function(t){this.outData.splice(t,1),this.addNew=!1},handleAmount:function(){this.outList.price&&(this.outList.subTotal=(this.outList.amount*this.outList.price).toFixed(2))},handlePrice:function(){this.outList.amount&&(this.outList.subTotal=(this.outList.price*this.outList.amount).toFixed(2))}}},n=l,u=s("2877"),c=Object(u["a"])(n,i,o,!1,null,"22bcdf18",null),d=c.exports,m=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Form",{ref:"material",staticClass:"ivu-mt",attrs:{model:t.logisticsList}},[s("Table",{ref:"process",attrs:{data:t.logisticsData,columns:t.logisticsListColumn},scopedSlots:t._u([{key:"logisticsCompany",fn:function(e){var r=e.row,a=e.index;return[t.editIndex===a?s("FormItem",{attrs:{prop:"logisticsCompany",rules:t.ruled}},[s("Input",{staticClass:"ivu-mt-16",attrs:{type:"text",placeholder:"请输入物流公司"},model:{value:t.logisticsList.logisticsCompany,callback:function(e){t.$set(t.logisticsList,"logisticsCompany",e)},expression:"logisticsList.logisticsCompany"}})],1):s("span",[t._v(t._s(r.logisticsCompany))])]}},{key:"plateNumber",fn:function(e){var r=e.row,a=e.index;return[t.editIndex===a?s("FormItem",{attrs:{prop:"plateNumber",rules:t.ruled}},[s("Input",{staticClass:"ivu-mt-16",attrs:{type:"text",placeholder:"请输入运送车牌号"},model:{value:t.logisticsList.plateNumber,callback:function(e){t.$set(t.logisticsList,"plateNumber",e)},expression:"logisticsList.plateNumber"}})],1):s("span",[t._v(t._s(r.plateNumber))])]}},{key:"driver",fn:function(e){var r=e.row,a=e.index;return[t.editIndex===a?s("FormItem",{staticClass:"ivu-mt-16",attrs:{prop:"driver",rules:t.ruled}},[s("Input",{attrs:{type:"text",placeholder:"请输入司机姓名"},model:{value:t.logisticsList.driver,callback:function(e){t.$set(t.logisticsList,"driver",e)},expression:"logisticsList.driver"}})],1):s("span",[t._v(t._s(r.driver))])]}},{key:"driverPhone",fn:function(e){var r=e.row,a=e.index;return[t.editIndex===a?s("FormItem",{attrs:{prop:"driverPhone",rules:t.ruled}},[s("Input",{staticClass:"ivu-mt-16",attrs:{placeholder:"请输入司机电话"},model:{value:t.logisticsList.driverPhone,callback:function(e){t.$set(t.logisticsList,"driverPhone",e)},expression:"logisticsList.driverPhone"}})],1):s("span",[t._v(t._s(r.driverPhone))])]}},{key:"action",fn:function(e){e.row;var r=e.index;return[t.editIndex===r?s("div",[s("Button",{staticClass:"ivu-ml",attrs:{type:"error",ghost:"",size:"small"},on:{click:function(e){return t.handleDelete(r)}}},[t._v("删除")])],1):s("div",[s("Poptip",{attrs:{confirm:"",transfer:"",title:"是否要删除此行？"},on:{"on-ok":function(e){return t.handleDelete(r)}}},[s("Button",{staticClass:"ivu-ml",attrs:{type:"error",disabled:t.addNew,ghost:"",size:"small"}},[t._v("删除")])],1)],1)]}}])})],1),s("Button",{staticClass:"ivu-mt",attrs:{type:"dashed",long:"",icon:"md-add"},on:{click:t.handleAdd}},[t._v("新增记录")])],1)},p=[],h={name:"logistics-form",data:function(){return{loading:!1,logisticsList:{logisticsCompany:"",plateNumber:"",driver:"",driverPhone:""},logisticsListColumn:[{title:"物流公司",slot:"logisticsCompany",minWidth:80},{title:"车牌号",slot:"plateNumber",minWidth:100},{title:"司机",slot:"driver",minWidth:60},{title:"司机电话",slot:"driverPhone",minWidth:120},{title:"操作",slot:"action",align:"center",width:140}],ruled:{required:!0,message:"请输入",trigger:"blur"},editIndex:-1,addNew:!1,logisticsData:[]}},methods:{handleEdit:function(t,e){this.logisticsList=t,this.editIndex=e},handleRuled:function(){var t=!1;return this.$refs.material.validate((function(e){t=e})),t},handleAdd:function(){if(this.addNew=!0,!this.handleRuled())return 0;var t={logisticsList:"",logisticsCompany:"",plateNumber:"",driver:"",driverPhone:""};this.logisticsData.push(t),this.handleEdit(t,this.logisticsData.length-1)},handleDelete:function(t){this.logisticsData.splice(t,1),this.addNew=!1}}},g=h,v=Object(u["a"])(g,m,p,!1,null,"3b296118",null),f=v.exports,b={name:"storage-edit",components:{outForm:d,logisticsForm:f},data:function(){return{loading:!1,breadcrumbList:[{title:"基地",to:"/plant"},{title:"仓储管理",to:"/plant/storage"},{title:"入库编辑"}],storage:{type:"",outNumber:"",warehouseId:"",outTime:"",customer:"",principal:"",contact:"",contactPhone:"",region:"",address:"",remark:""},ruled:{required:!0,message:"请输入",trigger:"blur"}}},computed:{},mounted:function(){this.loadData()},methods:{loadData:function(){this.$route.query.id},handleSubmit:function(){var t=this,e=this.$refs.outForm,s=this.$refs.logisticsForm;this.$refs["form"].validate((function(r){if(r){if(s.logisticsData.length>0&&!s.handleRuled())return void t.$Message.error("请填写物流信息");e.outData.length>0&&e.handleRuled()?(t.$Message.success("Success!"),t.$router.replace({name:"plant-storage-out"})):t.$Message.error("请填写销售明细")}else t.$Message.error("Fail!")}))}}},x=b,I=Object(u["a"])(x,r,a,!1,null,null,null);e["default"]=I.exports}}]);