(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e8822"],{"8a25":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"i-layout-page-header"},[a("PageHeader",{attrs:{title:"新建入库/编辑入库","breadcrumb-list":t.breadcrumbList}})],1),a("Form",{ref:"form",staticClass:"ivu-mt",attrs:{model:t.storage}},[a("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":"",title:"基本信息"}},[a("Row",{attrs:{gutter:24}},[a("Col",{attrs:{xl:8,lg:8,md:8,sm:24,xs:24}},[a("FormItem",{attrs:{label:"入库类型",prop:"type",rules:t.ruled}},[a("Select",{model:{value:t.storage.type,callback:function(e){t.$set(t.storage,"type",e)},expression:"storage.type"}},[a("Option",{attrs:{value:"1"}},[t._v("加工入库")]),a("Option",{attrs:{value:"2"}},[t._v("采购入库")])],1)],1)],1),a("Col",{attrs:{xl:8,lg:8,md:8,sm:24,xs:24}},[a("FormItem",{attrs:{label:"仓库",prop:"warehouseName",rules:t.ruled}},[a("Input",{model:{value:t.storage.warehouseName,callback:function(e){t.$set(t.storage,"warehouseName",e)},expression:"storage.warehouseName"}})],1)],1),a("Col",{attrs:{xl:8,lg:8,md:8,sm:24,xs:24}},[a("FormItem",{attrs:{label:"入库时间",prop:"inTime",rules:t.ruled}},[a("Input",{attrs:{type:"date"},model:{value:t.storage.inTime,callback:function(e){t.$set(t.storage,"inTime",e)},expression:"storage.inTime"}})],1)],1),a("Col",{attrs:{xl:8,lg:8,md:8,sm:24,xs:24}},[a("FormItem",{attrs:{label:"入库单号",prop:"inNumber",rules:t.ruled}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:t.storage.inNumber,callback:function(e){t.$set(t.storage,"inNumber",e)},expression:"storage.inNumber"}})],1)],1),a("Col",{attrs:{xl:8,lg:8,md:8,sm:24,xs:24}},[a("FormItem",{attrs:{label:"负责人",prop:"principal",rules:t.ruled}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:t.storage.principal,callback:function(e){t.$set(t.storage,"principal",e)},expression:"storage.principal"}})],1)],1),a("Col",{attrs:{xl:8,lg:8,md:8,sm:24,xs:24}},["2"===t.storage.type?a("FormItem",{attrs:{label:"供应商",prop:"supplier",rules:t.ruled}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:t.storage.supplier,callback:function(e){t.$set(t.storage,"supplier",e)},expression:"storage.supplier"}})],1):t._e()],1),a("Col",{attrs:{xl:24,lg:24,md:24,sm:24,xs:24}},[a("FormItem",{attrs:{label:"备注",prop:"remark"}},[a("Input",{attrs:{type:"textarea",rows:4,placeholder:"请输入备注"},model:{value:t.storage.remark,callback:function(e){t.$set(t.storage,"remark",e)},expression:"storage.remark"}})],1)],1)],1)],1),a("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":"",title:"入库明细"}},["2"===t.storage.type?a("procurement-form",{ref:"table"}):a("process-from",{ref:"table"})],1)],1),a("FooterToolbar",[a("Button",{attrs:{type:"primary",loading:t.loading,size:"large"},on:{click:t.handleSubmit}},[t._v("提交")])],1)],1)},r=[],s=(a("a481"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Form",{ref:"material",staticClass:"ivu-mt",attrs:{model:t.materialList}},[a("Table",{ref:"process",attrs:{data:t.tableData,columns:t.columns},scopedSlots:t._u([{key:"name",fn:function(e){var i=e.row,r=e.index;return[t.editIndex===r?a("FormItem",{attrs:{prop:"name",rules:t.ruled}},[a("Input",{staticClass:"ivu-mt-16",attrs:{type:"text"},model:{value:t.materialList.name,callback:function(e){t.$set(t.materialList,"name",e)},expression:"materialList.name"}})],1):a("span",[t._v(t._s(i.name))])]}},{key:"specification",fn:function(e){var i=e.row,r=e.index;return[t.editIndex===r?a("FormItem",{attrs:{prop:"specification",rules:t.ruled}},[a("Input",{staticClass:"ivu-mt-16",attrs:{type:"text"},model:{value:t.materialList.specification,callback:function(e){t.$set(t.materialList,"specification",e)},expression:"materialList.specification"}})],1):a("span",[t._v(t._s(i.specification))])]}},{key:"batchNumber",fn:function(e){var i=e.row,r=e.index;return[t.editIndex===r?a("FormItem",{staticClass:"ivu-mt-16",attrs:{prop:"batchNumber",rules:t.ruled}},[a("Input",{attrs:{type:"text"},model:{value:t.materialList.batchNumber,callback:function(e){t.$set(t.materialList,"batchNumber",e)},expression:"materialList.batchNumber"}})],1):a("span",[t._v(t._s(i.batchNumber))])]}},{key:"availableAmount",fn:function(e){var i=e.row,r=e.index;return[t.editIndex===r?a("FormItem",{staticClass:"ivu-mt-16",attrs:{prop:"availableAmount",rules:t.ruled}},[a("Input",{attrs:{type:"number"},model:{value:t.materialList.availableAmount,callback:function(e){t.$set(t.materialList,"availableAmount",e)},expression:"materialList.availableAmount"}})],1):a("span",[t._v(t._s(i.availableAmount))])]}},{key:"amount",fn:function(e){var i=e.row,r=e.index;return[t.editIndex===r?a("FormItem",{attrs:{prop:"amount",rules:t.ruled}},[a("Input",{staticClass:"ivu-mt-16",attrs:{type:"number"},model:{value:t.materialList.amount,callback:function(e){t.$set(t.materialList,"amount",e)},expression:"materialList.amount"}})],1):a("span",[t._v(t._s(i.amount))])]}},{key:"unit",fn:function(e){var i=e.row,r=e.index;return[t.editIndex===r?a("FormItem",{staticClass:"ivu-mt-16",attrs:{prop:"unit",rules:t.ruled}},[a("Input",{attrs:{type:"text"},model:{value:t.materialList.unit,callback:function(e){t.$set(t.materialList,"unit",e)},expression:"materialList.unit"}})],1):a("span",[t._v(t._s(i.unit))])]}},{key:"action",fn:function(e){e.row;var i=e.index;return[t.editIndex===i?a("div",[a("Button",{staticClass:"ivu-ml",attrs:{type:"error",ghost:"",size:"small"},on:{click:function(e){return t.handleDelete(i)}}},[t._v("删除")])],1):a("div",[a("Poptip",{attrs:{confirm:"",transfer:"",title:"是否要删除此行？"},on:{"on-ok":function(e){return t.handleDelete(i)}}},[a("Button",{staticClass:"ivu-ml",attrs:{type:"error",disabled:t.addNew,ghost:"",size:"small"}},[t._v("删除")])],1)],1)]}}])})],1),a("Button",{staticClass:"ivu-mt",attrs:{type:"dashed",long:"",icon:"md-add"},on:{click:t.handleAdd}},[t._v("新增成员")])],1)}),n=[],l={name:"process-form",data:function(){return{loading:!1,materialList:{name:"",specification:"",batchNumber:"",availableAmount:"",amount:"",unit:""},ruled:{required:!0,message:"请填写信息",trigger:"blue"},columns:[{title:"物料名称",slot:"name",minWidth:120},{title:"规格",slot:"specification",minWidth:120},{title:"批号",slot:"batchNumber",minWidth:120},{title:"可用数量",slot:"availableAmount",minWidth:120},{title:"数量",slot:"amount",minWidth:120},{title:"单位",slot:"unit",minWidth:120},{title:"操作",slot:"action",align:"center",width:140}],editIndex:-1,addNew:!1,tableData:[]}},methods:{handleEdit:function(t,e){this.materialList=t,this.editIndex=e},handleRuled:function(){var t=!1;return this.$refs.material.validate((function(e){t=e})),t},handleAdd:function(){if(this.addNew=!0,!this.handleRuled())return 0;var t={name:"",specification:"",batchNumber:"",availableAmount:"",amount:"",unit:""};this.tableData.push(t),this.handleEdit(t,this.tableData.length-1)},handleDelete:function(t){this.tableData.splice(t,1),this.addNew=!1}}},o=l,u=a("2877"),m=Object(u["a"])(o,s,n,!1,null,"26ce0bb9",null),c=m.exports,d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Form",{ref:"material",staticClass:"ivu-mt",attrs:{model:t.materialList}},[a("Table",{ref:"process",attrs:{data:t.tableData,columns:t.columns},scopedSlots:t._u([{key:"sourceName",fn:function(e){var i=e.row,r=e.index;return[t.editIndex===r?a("FormItem",{attrs:{prop:"sourceName",rules:t.ruled}},[a("Input",{staticClass:"ivu-mt-16",attrs:{type:"text",placeholder:"请输入物料名称"},model:{value:t.materialList.sourceName,callback:function(e){t.$set(t.materialList,"sourceName",e)},expression:"materialList.sourceName"}})],1):a("span",[t._v(t._s(i.sourceName))])]}},{key:"sourceSpecification",fn:function(e){var i=e.row,r=e.index;return[t.editIndex===r?a("FormItem",{attrs:{prop:"sourceSpecification",rules:t.ruled}},[a("Input",{staticClass:"ivu-mt-16",attrs:{type:"text"},model:{value:t.materialList.sourceSpecification,callback:function(e){t.$set(t.materialList,"sourceSpecification",e)},expression:"materialList.sourceSpecification"}})],1):a("span",[t._v(t._s(i.sourceSpecification))])]}},{key:"sourceBatchNumber",fn:function(e){var i=e.row,r=e.index;return[t.editIndex===r?a("FormItem",{staticClass:"ivu-mt-16",attrs:{prop:"sourceBatchNumber",rules:t.ruled}},[a("Input",{attrs:{type:"text",placeholder:"请输入批号"},model:{value:t.materialList.sourceBatchNumber,callback:function(e){t.$set(t.materialList,"sourceBatchNumber",e)},expression:"materialList.sourceBatchNumber"}})],1):a("span",[t._v(t._s(i.sourceBatchNumber))])]}},{key:"name",fn:function(e){var i=e.row,r=e.index;return[t.editIndex===r?a("FormItem",{attrs:{prop:"name",rules:t.ruled}},[a("Input",{staticClass:"ivu-mt-16",attrs:{type:"text",placeholder:"请输入物料名称"},model:{value:t.materialList.name,callback:function(e){t.$set(t.materialList,"name",e)},expression:"materialList.name"}})],1):a("span",[t._v(t._s(i.name))])]}},{key:"specification",fn:function(e){var i=e.row,r=e.index;return[t.editIndex===r?a("FormItem",{attrs:{prop:"specification",rules:t.ruled}},[a("Input",{staticClass:"ivu-mt-16",attrs:{type:"text"},model:{value:t.materialList.specification,callback:function(e){t.$set(t.materialList,"specification",e)},expression:"materialList.specification"}})],1):a("span",[t._v(t._s(i.specification))])]}},{key:"batchNumber",fn:function(e){var i=e.row,r=e.index;return[t.editIndex===r?a("FormItem",{staticClass:"ivu-mt-16",attrs:{prop:"batchNumber",rules:t.ruled}},[a("Input",{attrs:{type:"text",placeholder:"请输入批号"},model:{value:t.materialList.batchNumber,callback:function(e){t.$set(t.materialList,"batchNumber",e)},expression:"materialList.batchNumber"}})],1):a("span",[t._v(t._s(i.batchNumber))])]}},{key:"amount",fn:function(e){var i=e.row,r=e.index;return[t.editIndex===r?a("FormItem",{attrs:{prop:"amount",rules:t.ruled}},[a("Input",{staticClass:"ivu-mt-16",attrs:{type:"number"},on:{"on-change":t.handleAmount},model:{value:t.materialList.amount,callback:function(e){t.$set(t.materialList,"amount",e)},expression:"materialList.amount"}})],1):a("span",[t._v(t._s(i.amount))])]}},{key:"unit",fn:function(e){var i=e.row,r=e.index;return[t.editIndex===r?a("FormItem",{staticClass:"ivu-mt-16",attrs:{prop:"unit",rules:t.ruled}},[a("Input",{attrs:{type:"text"},model:{value:t.materialList.unit,callback:function(e){t.$set(t.materialList,"unit",e)},expression:"materialList.unit"}})],1):a("span",[t._v(t._s(i.unit))])]}},{key:"price",fn:function(e){var i=e.row,r=e.index;return[t.editIndex===r?a("FormItem",{staticClass:"ivu-mt-16",attrs:{prop:"price",rules:t.ruled}},[a("Input",{attrs:{type:"number",placeholder:"单价"},on:{"on-change":t.handlePrice},model:{value:t.materialList.price,callback:function(e){t.$set(t.materialList,"price",e)},expression:"materialList.price"}})],1):a("span",[t._v(t._s(i.price))])]}},{key:"total",fn:function(e){var i=e.row,r=e.index;return[t.editIndex===r?a("p",[t._v(t._s(t.materialList.total))]):a("span",[t._v(t._s(i.total))])]}},{key:"action",fn:function(e){e.row;var i=e.index;return[t.editIndex===i?a("div",[a("Button",{staticClass:"ivu-ml",attrs:{type:"error",ghost:"",size:"small"},on:{click:function(e){return t.handleDelete(i)}}},[t._v("删除")])],1):a("div",[a("Poptip",{attrs:{confirm:"",transfer:"",title:"是否要删除此行？"},on:{"on-ok":function(e){return t.handleDelete(i)}}},[a("Button",{staticClass:"ivu-ml",attrs:{type:"error",disabled:t.addNew,ghost:"",size:"small"}},[t._v("删除")])],1)],1)]}}])})],1),a("Button",{staticClass:"ivu-mt",attrs:{type:"dashed",long:"",icon:"md-add"},on:{click:t.handleAdd}},[t._v("新增成员")])],1)},p=[],h={name:"process-form",data:function(){return{loading:!1,materialList:{sourceName:"",sourceSpecification:"",sourceBatchNumber:"",name:"",specification:"",batchNumber:"",amount:"",unit:"",price:"",total:""},ruled:{required:!0,message:"请填写信息",trigger:"blue"},columns:[{title:"物料名称",slot:"sourceName",minWidth:40},{title:"规格",slot:"sourceSpecification",minWidth:60},{title:"外部批号",slot:"sourceBatchNumber",minWidth:120},{title:"物料名称",slot:"name",minWidth:40},{title:"规格",slot:"specification",minWidth:60},{title:"内部批号",slot:"batchNumber",minWidth:120},{title:"数量",slot:"amount",minWidth:40},{title:"单位",slot:"unit",minWidth:40},{title:"单价",slot:"price",minWidth:40},{title:"小计",slot:"total",minWidth:60},{title:"操作",slot:"action",align:"center",width:140}],editIndex:-1,addNew:!1,tableData:[]}},methods:{handleEdit:function(t,e){this.materialList=t,this.editIndex=e},handleRuled:function(){var t=!1;return this.$refs.material.validate((function(e){t=e})),t},handleAdd:function(){if(this.addNew=!0,!this.handleRuled())return 0;var t={sourceName:"",sourceSpecification:"",sourceBatchNumber:"",name:"",specification:"",batchNumber:"",amount:"",unit:"",price:"",total:"-"};this.tableData.push(t),this.handleEdit(t,this.tableData.length-1)},handleDelete:function(t){this.tableData.splice(t,1),this.addNew=!1},handleAmount:function(){this.materialList.price&&(this.materialList.total=(this.materialList.amount*this.materialList.price).toFixed(2))},handlePrice:function(t){this.materialList.amount&&(this.materialList.total=(this.materialList.price*this.materialList.amount).toFixed(2))}}},f=h,b=Object(u["a"])(f,d,p,!1,null,"cb23c204",null),v=b.exports,x={name:"storage-edit",components:{processFrom:c,procurementForm:v},data:function(){return{loading:!1,breadcrumbList:[{title:"基地",to:"/plant"},{title:"仓储管理"},{title:"入库编辑"}],storage:{type:"",inNumber:"",warehouseName:"",inTime:"",principal:"",supplier:"",remark:""},ruled:{required:!0,message:"请输入",trigger:"blur"}}},computed:{},mounted:function(){this.loadData()},methods:{loadData:function(){this.$route.query.id},handleSubmit:function(){var t=this,e=this.$refs.table;this.$refs["form"].validate((function(a){a?e.tableData.length>0&&e.handleRuled()?(t.$Message.success("Success!"),t.$router.replace({name:"plant-storage-in"})):t.$Message.error("请填写入库明细"):t.$Message.error("Fail!")}))}}},g=x,I=Object(u["a"])(g,i,r,!1,null,null,null);e["default"]=I.exports}}]);